import{c as U,r as v,N as K,j as o,T as fe,B as V,q as te,o as we,a as T,g as ne,Q as me,k as pe,H as ge,S as be,d as A,P as ve,J as re,V as xe,L as q,G as ye,U as ke,w as G}from"./index-Cwzn0Rv2.js";import{p as je,H as Ce,C as Se,a as Ne,T as _e}from"./atom-one-dark-CFck_wUQ.js";import{A as Le}from"./arrow-left-BkWR1XFE.js";import{f as Pe}from"./format-Dpr0NHdZ.js";const Oe=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Ee=U("arrow-down",Oe);const He=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Ae=U("arrow-up",He);const Me=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Re=U("message-square",Me);function ie({onSubmit:e,initialText:t="",buttonText:n="Post Comment",onCancel:i}){const[a,s]=v.useState(t),[l,h]=v.useState(!1),{user:u}=K(),r=async c=>{if(c.preventDefault(),!(!a.trim()||!u)){h(!0);try{await e(a),s("")}catch(d){console.error("Error submitting comment:",d)}finally{h(!1)}}};return o.jsxs("form",{onSubmit:r,className:"flex flex-col gap-3",children:[o.jsx(fe,{value:a,onChange:c=>s(c.target.value),placeholder:"Write a comment...",required:!0,rows:3,disabled:!u}),o.jsxs("div",{className:"flex justify-end gap-2",children:[i&&o.jsx(V,{type:"button",variant:"ghost",onClick:i,children:"Cancel"}),o.jsx(V,{type:"submit",disabled:l||!a.trim(),children:l?"Posting...":n})]})]})}const oe=({comment:e,onReply:t,onVote:n})=>{const[i,a]=v.useState(!1),{user:s}=K();return o.jsxs("div",{className:"flex gap-3 my-4",children:[o.jsx("img",{src:e.authorPhotoURL||"/default-avatar.png",alt:e.authorName,className:"w-8 h-8 rounded-full mt-1"}),o.jsxs("div",{className:"flex-grow",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"font-bold text-sm text-surface",children:e.authorName}),o.jsx("span",{className:"text-xs text-surface/60",children:new Date(e.createdAt?.toDate()).toLocaleString()})]}),o.jsx("p",{className:"text-surface/90 mt-1",children:e.text}),o.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-surface/60",children:[o.jsxs("button",{onClick:()=>n(e.id,"up"),className:"flex items-center gap-1 hover:text-accent transition-colors",children:[o.jsx(Ae,{size:14})," ",e.upvotes]}),o.jsxs("button",{onClick:()=>n(e.id,"down"),className:"flex items-center gap-1 hover:text-red-400 transition-colors",children:[o.jsx(Ee,{size:14})," ",e.downvotes]}),o.jsxs("button",{onClick:()=>a(!i),className:"flex items-center gap-1 hover:text-accent transition-colors",children:[o.jsx(Re,{size:14})," Reply"]})]}),i&&s&&o.jsx("div",{className:"mt-3",children:o.jsx(ie,{onSubmit:async l=>{await t(e.id,l),a(!1)},buttonText:"Post Reply",onCancel:()=>a(!1)})}),e.replies&&e.replies.length>0&&o.jsx("div",{className:"mt-4 pl-4 border-l-2 border-surface/10",children:e.replies.map(l=>o.jsx(oe,{comment:l,onReply:t,onVote:n},l.id))})]})]})};function We({postId:e}){const[t,n]=v.useState([]),{user:i,loading:a}=K(),s=v.useCallback(async()=>{const u=te(T(A,"posts",e,"comments"),we("createdAt","desc")),c=(await ne(u)).docs.map(w=>({id:w.id,...w.data()})),d=new Map(c.map(w=>[w.id,{...w,replies:[]}])),f=[];c.forEach(w=>{w.parentId&&d.has(w.parentId)?d.get(w.parentId).replies.push(d.get(w.id)):f.push(d.get(w.id))}),n(f)},[e]);v.useEffect(()=>{s()},[s]);const l=v.useCallback(async(u,r=null)=>{if(!i)throw new Error("User not authenticated");await me(T(A,"posts",e,"comments"),{authorId:i.uid,authorName:i.displayName||"Anonymous",authorPhotoURL:i.photoURL||"",text:u,createdAt:ve(),upvotes:0,downvotes:0,parentId:r}),s()},[i,e,s]),h=v.useCallback(async(u,r)=>{if(!i)return alert("Please sign in to vote.");const c=pe(A,"posts",e,"comments",u);await ge(c,{[r==="up"?"upvotes":"downvotes"]:be(1)}),s()},[i,e,s]);return o.jsxs("div",{className:"mt-12",children:[o.jsx("h2",{className:"text-2xl font-bold text-surface mb-6",children:"Comments"}),o.jsx("div",{className:"mb-8",children:o.jsx(ie,{onSubmit:u=>l(u)})}),a?o.jsx("p",{className:"text-center text-surface/60 py-8",children:"Loading comments..."}):t.length>0?o.jsx("div",{children:t.map(u=>o.jsx(oe,{comment:u,onReply:(r,c)=>l(c,r),onVote:h},u.id))}):o.jsx("p",{className:"text-center text-surface/60 py-8",children:"No comments yet. Be the first to share your thoughts!"})]})}var B={exports:{}};var Z;function ze(){return Z||(Z=1,(function(e){(function(){var t={}.hasOwnProperty;function n(){for(var s="",l=0;l<arguments.length;l++){var h=arguments[l];h&&(s=a(s,i(h)))}return s}function i(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return n.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var l="";for(var h in s)t.call(s,h)&&s[h]&&(l=a(l,h));return l}function a(s,l){return l?s?s+" "+l:s+l:s}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(B)),B.exports}var qe=ze();const se=re(qe);var E={exports:{}},H={exports:{}},D,Q;function Be(){if(Q)return D;Q=1;var e=1e3,t=e*60,n=t*60,i=n*24,a=i*365.25;D=function(r,c){c=c||{};var d=typeof r;if(d==="string"&&r.length>0)return s(r);if(d==="number"&&isNaN(r)===!1)return c.long?h(r):l(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function s(r){if(r=String(r),!(r.length>100)){var c=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(r);if(c){var d=parseFloat(c[1]),f=(c[2]||"ms").toLowerCase();switch(f){case"years":case"year":case"yrs":case"yr":case"y":return d*a;case"days":case"day":case"d":return d*i;case"hours":case"hour":case"hrs":case"hr":case"h":return d*n;case"minutes":case"minute":case"mins":case"min":case"m":return d*t;case"seconds":case"second":case"secs":case"sec":case"s":return d*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return d;default:return}}}}function l(r){return r>=i?Math.round(r/i)+"d":r>=n?Math.round(r/n)+"h":r>=t?Math.round(r/t)+"m":r>=e?Math.round(r/e)+"s":r+"ms"}function h(r){return u(r,i,"day")||u(r,n,"hour")||u(r,t,"minute")||u(r,e,"second")||r+" ms"}function u(r,c,d){if(!(r<c))return r<c*1.5?Math.floor(r/c)+" "+d:Math.ceil(r/c)+" "+d+"s"}return D}var X;function De(){return X||(X=1,(function(e,t){t=e.exports=a.debug=a.default=a,t.coerce=u,t.disable=l,t.enable=s,t.enabled=h,t.humanize=Be(),t.names=[],t.skips=[],t.formatters={};var n;function i(r){var c=0,d;for(d in r)c=(c<<5)-c+r.charCodeAt(d),c|=0;return t.colors[Math.abs(c)%t.colors.length]}function a(r){function c(){if(c.enabled){var d=c,f=+new Date,w=f-(n||f);d.diff=w,d.prev=n,d.curr=f,n=f;for(var b=new Array(arguments.length),y=0;y<b.length;y++)b[y]=arguments[y];b[0]=t.coerce(b[0]),typeof b[0]!="string"&&b.unshift("%O");var k=0;b[0]=b[0].replace(/%([a-zA-Z%])/g,function(S,_){if(S==="%%")return S;k++;var P=t.formatters[_];if(typeof P=="function"){var L=b[k];S=P.call(d,L),b.splice(k,1),k--}return S}),t.formatArgs.call(d,b);var N=c.log||t.log||console.log.bind(console);N.apply(d,b)}}return c.namespace=r,c.enabled=t.enabled(r),c.useColors=t.useColors(),c.color=i(r),typeof t.init=="function"&&t.init(c),c}function s(r){t.save(r),t.names=[],t.skips=[];for(var c=(typeof r=="string"?r:"").split(/[\s,]+/),d=c.length,f=0;f<d;f++)c[f]&&(r=c[f].replace(/\*/g,".*?"),r[0]==="-"?t.skips.push(new RegExp("^"+r.substr(1)+"$")):t.names.push(new RegExp("^"+r+"$")))}function l(){t.enable("")}function h(r){var c,d;for(c=0,d=t.skips.length;c<d;c++)if(t.skips[c].test(r))return!1;for(c=0,d=t.names.length;c<d;c++)if(t.names[c].test(r))return!0;return!1}function u(r){return r instanceof Error?r.stack||r.message:r}})(H,H.exports)),H.exports}var Y;function Ie(){return Y||(Y=1,(function(e,t){var n={};t=e.exports=De(),t.log=s,t.formatArgs=a,t.save=l,t.load=h,t.useColors=i,t.storage=typeof chrome<"u"&&typeof chrome.storage<"u"?chrome.storage.local:u(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function i(){return typeof window<"u"&&window.process&&window.process.type==="renderer"?!0:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}t.formatters.j=function(r){try{return JSON.stringify(r)}catch(c){return"[UnexpectedJSONParseError]: "+c.message}};function a(r){var c=this.useColors;if(r[0]=(c?"%c":"")+this.namespace+(c?" %c":" ")+r[0]+(c?"%c ":" ")+"+"+t.humanize(this.diff),!!c){var d="color: "+this.color;r.splice(1,0,d,"color: inherit");var f=0,w=0;r[0].replace(/%[a-zA-Z%]/g,function(b){b!=="%%"&&(f++,b==="%c"&&(w=f))}),r.splice(w,0,d)}}function s(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function l(r){try{r==null?t.storage.removeItem("debug"):t.storage.debug=r}catch{}}function h(){var r;try{r=t.storage.debug}catch{}return!r&&typeof process<"u"&&"env"in process&&(r=n.DEBUG),r}t.enable(h());function u(){try{return window.localStorage}catch{}}})(E,E.exports)),E.exports}var I,$;function Ve(){if($)return I;$=1;var e=Ie()("jsonp");I=i;var t=0;function n(){}function i(a,s,l){typeof s=="function"&&(l=s,s={}),s||(s={});var h=s.prefix||"__jp",u=s.name||h+t++,r=s.param||"callback",c=s.timeout!=null?s.timeout:6e4,d=encodeURIComponent,f=document.getElementsByTagName("script")[0]||document.head,w,b;c&&(b=setTimeout(function(){y(),l&&l(new Error("Timeout"))},c));function y(){w.parentNode&&w.parentNode.removeChild(w),window[u]=n,b&&clearTimeout(b)}function k(){window[u]&&y()}return window[u]=function(N){e("jsonp got",N),y(),l&&l(null,N)},a+=(~a.indexOf("?")?"&":"?")+r+"="+d(u),a=a.replace("?&","?"),e('jsonp req "%s"',a),w=document.createElement("script"),w.src=a,f.parentNode.insertBefore(w,f),k}return I}var Te=Ve();const j=re(Te);var Ue=Object.defineProperty,Ke=Object.defineProperties,Fe=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertySymbols,ae=Object.prototype.hasOwnProperty,ce=Object.prototype.propertyIsEnumerable,ee=(e,t,n)=>t in e?Ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,x=(e,t)=>{for(var n in t||(t={}))ae.call(t,n)&&ee(e,n,t[n]);if(M)for(var n of M(t))ce.call(t,n)&&ee(e,n,t[n]);return e},R=(e,t)=>Ke(e,Fe(t)),W=(e,t)=>{var n={};for(var i in e)ae.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(e!=null&&M)for(var i of M(e))t.indexOf(i)<0&&ce.call(e,i)&&(n[i]=e[i]);return n};function z(e){return n=>{var i=n,{bgStyle:a={},borderRadius:s=0,iconFillColor:l="white",round:h=!1,size:u=64}=i,r=W(i,["bgStyle","borderRadius","iconFillColor","round","size"]);return o.jsxs("svg",R(x({viewBox:"0 0 64 64",width:u,height:u},r),{children:[h?o.jsx("circle",{cx:"32",cy:"32",r:"32",fill:e.color,style:a}):o.jsx("rect",{width:"64",height:"64",rx:s,ry:s,fill:e.color,style:a}),o.jsx("path",{d:e.path,fill:l})]}))}}class Je extends Error{constructor(t){super(t),this.name="AssertionError"}}function p(e,t){if(!e)throw new Je(t)}function m(e){const t=Object.entries(e).filter(([,n])=>n!=null).map(([n,i])=>`${encodeURIComponent(n)}=${encodeURIComponent(String(i))}`);return t.length>0?`?${t.join("&")}`:""}const Ge=e=>!!e&&(typeof e=="object"||typeof e=="function")&&"then"in e&&typeof e.then=="function",Ze=(e,t)=>({left:window.outerWidth/2+(window.screenX||window.screenLeft||0)-e/2,top:window.outerHeight/2+(window.screenY||window.screenTop||0)-t/2}),Qe=(e,t)=>({top:(window.screen.height-t)/2,left:(window.screen.width-e)/2});function Xe(e,t,n){var i=t,{height:a,width:s}=i,l=W(i,["height","width"]);const h=x({height:a,width:s,location:"no",toolbar:"no",status:"no",directories:"no",menubar:"no",scrollbars:"yes",resizable:"no",centerscreen:"yes",chrome:"yes"},l),u=window.open(e,"",Object.keys(h).map(r=>`${r}=${h[r]}`).join(", "));if(n){const r=window.setInterval(()=>{try{(u===null||u.closed)&&(window.clearInterval(r),n(u))}catch(c){console.error(c)}},1e3)}return u}function Ye(e){var t=e,{beforeOnClick:n,children:i,className:a,disabled:s,disabledStyle:l={opacity:.6},forwardedRef:h,htmlTitle:u,networkLink:r,networkName:c,onClick:d,onShareWindowClose:f,openShareDialogOnClick:w=!0,opts:b,resetButtonStyle:y=!0,style:k,title:N,url:S,windowHeight:_=400,windowPosition:P="windowCenter",windowWidth:L=550}=t,le=W(t,["beforeOnClick","children","className","disabled","disabledStyle","forwardedRef","htmlTitle","networkLink","networkName","onClick","onShareWindowClose","openShareDialogOnClick","opts","resetButtonStyle","style","title","url","windowHeight","windowPosition","windowWidth"]);const de=async F=>{const J=r(S,b);if(!s){if(F.preventDefault(),n){const O=n();Ge(O)&&await O}if(w){const O=x({height:_,width:L},P==="windowCenter"?Ze(L,_):Qe(L,_));Xe(J,O,f)}d&&d(F,J)}},ue=se("react-share__ShareButton",{"react-share__ShareButton--disabled":!!s,disabled:!!s},a),he=x(x(y?{backgroundColor:"transparent",border:"none",padding:0,font:"inherit",color:"inherit",cursor:"pointer"}:{},k),s&&l);return o.jsx("button",R(x({},le),{className:ue,onClick:de,ref:h,style:he,title:u,children:i}))}function g(e,t,n,i){const a=(s,l)=>{const h=n(s),u=x({},s);return Object.keys(h).forEach(c=>{delete u[c]}),o.jsx(Ye,R(x(x({},i),u),{forwardedRef:l,networkName:e,networkLink:t,opts:h}))};return a.displayName=`ShareButton-${e}`,v.forwardRef(a)}function $e(e,{title:t,separator:n}){return p(e,"bluesky.url"),"https://bsky.app/intent/compose"+m({text:t?t+n+e:e})}g("bluesky",$e,e=>({title:e.title,separator:e.separator||" "}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});const et=z({color:"#7f7f7f",path:"M17,22v20h30V22H17z M41.1,25L32,32.1L22.9,25H41.1z M20,39V26.6l12,9.3l12-9.3V39H20z"});function tt(e,{subject:t,body:n,separator:i}){return"mailto:"+m({subject:t,body:n?n+i+e:e})}const nt=g("email",tt,e=>({subject:e.subject,body:e.body,separator:e.separator||" "}),{openShareDialogOnClick:!1,onClick:(e,t)=>{window.location.href=t}}),rt=z({color:"#0965FE",path:"M34.1,47V33.3h4.6l0.7-5.3h-5.3v-3.4c0-1.5,0.4-2.6,2.6-2.6l2.8,0v-4.8c-0.5-0.1-2.2-0.2-4.1-0.2 c-4.1,0-6.9,2.5-6.9,7V28H24v5.3h4.6V47H34.1z"});function it(e,{appId:t,redirectUri:n,to:i}){return"https://www.facebook.com/dialog/send"+m({link:e,redirect_uri:n||e,app_id:t,to:i})}g("facebookmessenger",it,e=>({appId:e.appId,redirectUri:e.redirectUri,to:e.to}),{windowWidth:1e3,windowHeight:820});function ot(e,{hashtag:t}){return p(e,"facebook.url"),"https://www.facebook.com/sharer/sharer.php"+m({u:e,hashtag:t})}const st=g("facebook",ot,e=>({hashtag:e.hashtag}),{windowWidth:550,windowHeight:400});function at(){const e=v.useRef(!1);return v.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),v.useCallback(()=>e.current,[])}function ct(e){var t=e,{children:n=f=>f,className:i,getCount:a,url:s}=t,l=W(t,["children","className","getCount","url"]);const h=at(),[u,r]=v.useState(void 0),[c,d]=v.useState(!1);return v.useEffect(()=>{d(!0),a(s,f=>{h()&&(r(f),d(!1))})},[s]),o.jsx("span",R(x({className:se("react-share__ShareCount",i)},l),{children:!c&&u!==void 0&&n(u)}))}function C(e){const t=n=>o.jsx(ct,x({getCount:e},n));return t.displayName=`ShareCount(${e.name})`,t}function lt(e,t){const n=`https://graph.facebook.com/?id=${e}&fields=og_object{engagement}`;j(n,(i,a)=>{t(!i&&a&&a.og_object&&a.og_object.engagement?a.og_object.engagement.count:void 0)})}C(lt);function dt(e,{title:t}){return p(e,"hatena.url"),`http://b.hatena.ne.jp/add?mode=confirm&url=${e}&title=${t}`}g("hatena",dt,e=>({title:e.title}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function ut(e,t){j("https://bookmark.hatenaapis.com/count/entry"+m({url:e}),(i,a)=>{t(a??void 0)})}C(ut);function ht(e,{title:t,description:n}){return p(e,"instapaper.url"),"http://www.instapaper.com/hello2"+m({url:e,title:t,description:n})}g("instapaper",ht,e=>({title:e.title,description:e.description}),{windowWidth:500,windowHeight:500,windowPosition:"windowCenter"});function ft(e,{title:t}){return p(e,"line.url"),"https://social-plugins.line.me/lineit/share"+m({url:e,text:t})}g("line",ft,e=>({title:e.title}),{windowWidth:500,windowHeight:500});const wt=z({color:"#0077B5",path:"M20.4,44h5.4V26.6h-5.4V44z M23.1,18c-1.7,0-3.1,1.4-3.1,3.1c0,1.7,1.4,3.1,3.1,3.1 c1.7,0,3.1-1.4,3.1-3.1C26.2,19.4,24.8,18,23.1,18z M39.5,26.2c-2.6,0-4.4,1.4-5.1,2.8h-0.1v-2.4h-5.2V44h5.4v-8.6 c0-2.3,0.4-4.5,3.2-4.5c2.8,0,2.8,2.6,2.8,4.6V44H46v-9.5C46,29.8,45,26.2,39.5,26.2z"});function mt(e,{title:t,summary:n,source:i}){return p(e,"linkedin.url"),"https://linkedin.com/shareArticle"+m({url:e,mini:"true",title:t,summary:n,source:i})}const pt=g("linkedin",mt,({title:e,summary:t,source:n})=>({title:e,summary:t,source:n}),{windowWidth:750,windowHeight:600});function gt(e,{title:t,description:n}){return p(e,"livejournal.url"),"https://www.livejournal.com/update.bml"+m({subject:t,event:n})}g("livejournal",gt,e=>({title:e.title,description:e.description}),{windowWidth:660,windowHeight:460});function bt(e,{title:t,description:n,imageUrl:i}){return p(e,"mailru.url"),"https://connect.mail.ru/share"+m({url:e,title:t,description:n,image_url:i})}g("mailru",bt,e=>({title:e.title,description:e.description,imageUrl:e.imageUrl}),{windowWidth:660,windowHeight:460});function vt(e,{title:t,description:n,image:i}){return p(e,"ok.url"),"https://connect.ok.ru/offer"+m({url:e,title:t,description:n,imageUrl:i})}g("ok",vt,e=>({title:e.title,description:e.description,image:e.image}),{windowWidth:588,windowHeight:480,windowPosition:"screenCenter"});function xt(e,t){window.OK||(window.OK={Share:{count:function(s,l){var h,u;(u=(h=window.OK.callbacks)[s])==null||u.call(h,l)}},callbacks:[]});const n="https://connect.ok.ru/dk",i=window.OK.callbacks.length;return window.ODKL={updateCount(a,s){var l,h;const u=a===""?0:parseInt(a.replace("react-share-",""),10);(h=(l=window.OK.callbacks)[u])==null||h.call(l,s===""?void 0:parseInt(s,10))}},window.OK.callbacks.push(t),j(n+m({"st.cmd":"extLike",uid:`react-share-${i}`,ref:e}))}C(xt);function yt(e,{media:t,description:n,pinId:i}){return i?`https://pinterest.com/pin/${i}/repin/x/`:(p(e,"pinterest.url"),p(t,"pinterest.media"),"https://pinterest.com/pin/create/button/"+m({url:e,media:t,description:n}))}g("pinterest",yt,e=>({media:e.media,description:e.description,pinId:e.pinId}),{windowWidth:1e3,windowHeight:730});function kt(e,t){j("https://api.pinterest.com/v1/urls/count.json"+m({url:e}),(i,a)=>{t(a?a.count:void 0)})}C(kt);function jt(e,{title:t}){return p(e,"pocket.url"),"https://getpocket.com/save"+m({url:e,title:t})}g("pocket",jt,e=>({title:e.title}),{windowWidth:500,windowHeight:500});function Ct(e,{title:t}){return p(e,"reddit.url"),"https://www.reddit.com/web/submit"+m({url:e,title:t})}g("reddit",Ct,e=>({title:e.title}),{windowWidth:660,windowHeight:460,windowPosition:"windowCenter"});function St(e,{title:t}){return p(e,"gab.url"),"https://gab.com/compose"+m({url:e,text:t})}g("gab",St,e=>({title:e.title}),{windowWidth:660,windowHeight:640,windowPosition:"windowCenter"});function Nt(e,t){const n=`https://www.reddit.com/api/info.json?limit=1&url=${e}`;j(n,{param:"jsonp"},(i,a)=>{t(!i&&a&&a.data&&a.data.children.length>0&&a.data.children[0].data.score?a.data.children[0].data.score:void 0)})}C(Nt);function _t(e,{title:t}){return p(e,"telegram.url"),"https://telegram.me/share/url"+m({url:e,text:t})}g("telegram",_t,e=>({title:e.title}),{windowWidth:550,windowHeight:400});function Lt(e,{title:t}){return p(e,"threads.url"),"https://threads.net/intent/post"+m({url:e,text:t})}g("threads",Lt,e=>({title:e.title}),{windowWidth:550,windowHeight:600});function Pt(e,{title:t,caption:n,tags:i,posttype:a}){return p(e,"tumblr.url"),"https://www.tumblr.com/widgets/share/tool"+m({canonicalUrl:e,title:t,caption:n,tags:i,posttype:a})}g("tumblr",Pt,e=>({title:e.title,tags:(e.tags||[]).join(","),caption:e.caption,posttype:e.posttype||"link"}),{windowWidth:660,windowHeight:460});function Ot(e,t){return j("https://api.tumblr.com/v2/share/stats"+m({url:e}),(i,a)=>{t(!i&&a&&a.response?a.response.note_count:void 0)})}C(Ot);const Et=z({color:"#00aced",path:"M48,22.1c-1.2,0.5-2.4,0.9-3.8,1c1.4-0.8,2.4-2.1,2.9-3.6c-1.3,0.8-2.7,1.3-4.2,1.6 C41.7,19.8,40,19,38.2,19c-3.6,0-6.6,2.9-6.6,6.6c0,0.5,0.1,1,0.2,1.5c-5.5-0.3-10.3-2.9-13.5-6.9c-0.6,1-0.9,2.1-0.9,3.3 c0,2.3,1.2,4.3,2.9,5.5c-1.1,0-2.1-0.3-3-0.8c0,0,0,0.1,0,0.1c0,3.2,2.3,5.8,5.3,6.4c-0.6,0.1-1.1,0.2-1.7,0.2c-0.4,0-0.8,0-1.2-0.1 c0.8,2.6,3.3,4.5,6.1,4.6c-2.2,1.8-5.1,2.8-8.2,2.8c-0.5,0-1.1,0-1.6-0.1c2.9,1.9,6.4,2.9,10.1,2.9c12.1,0,18.7-10,18.7-18.7 c0-0.3,0-0.6,0-0.8C46,24.5,47.1,23.4,48,22.1z"});function Ht(e,{title:t,via:n,hashtags:i=[],related:a=[]}){return p(e,"twitter.url"),p(Array.isArray(i),"twitter.hashtags is not an array"),p(Array.isArray(a),"twitter.related is not an array"),"https://twitter.com/intent/tweet"+m({url:e,text:t,via:n,hashtags:i.length>0?i.join(","):void 0,related:a.length>0?a.join(","):void 0})}const At=g("twitter",Ht,e=>({hashtags:e.hashtags,title:e.title,via:e.via,related:e.related}),{windowWidth:550,windowHeight:400});function Mt(e,{title:t,separator:n}){return p(e,"viber.url"),"viber://forward"+m({text:t?t+n+e:e})}g("viber",Mt,e=>({title:e.title,separator:e.separator||" "}),{windowWidth:660,windowHeight:460});function Rt(e,{title:t,image:n,noParse:i,noVkLinks:a}){return p(e,"vk.url"),"https://vk.com/share.php"+m({url:e,title:t,image:n,noparse:i?1:0,no_vk_links:a?1:0})}g("vk",Rt,e=>({title:e.title,image:e.image,noParse:e.noParse,noVkLinks:e.noVkLinks}),{windowWidth:660,windowHeight:460});function Wt(e,t){window.VK||(window.VK={}),window.VK.Share={count:(a,s)=>{var l,h;return(h=(l=window.VK.callbacks)==null?void 0:l[a])==null?void 0:h.call(l,s)}},window.VK.callbacks=[];const n="https://vk.com/share.php",i=window.VK.callbacks.length;return window.VK.callbacks.push(t),j(n+m({act:"count",index:i,url:e}))}C(Wt);function zt(e,{title:t,image:n}){return p(e,"weibo.url"),"http://service.weibo.com/share/share.php"+m({url:e,title:t,pic:n})}g("weibo",zt,e=>({title:e.title,image:e.image}),{windowWidth:660,windowHeight:550,windowPosition:"screenCenter"});function qt(){return/(android|iphone|ipad|mobile)/i.test(navigator.userAgent)}function Bt(e,{title:t,separator:n}){return p(e,"whatsapp.url"),"https://"+(qt()?"api":"web")+".whatsapp.com/send"+m({text:t?t+n+e:e})}g("whatsapp",Bt,e=>({title:e.title,separator:e.separator||" "}),{windowWidth:550,windowHeight:400});function Dt(e,{quote:t,hashtag:n}){return p(e,"workplace.url"),"https://work.facebook.com/sharer.php"+m({u:e,quote:t,hashtag:n})}g("workplace",Dt,e=>({quote:e.quote,hashtag:e.hashtag}),{windowWidth:550,windowHeight:400});const It=({post:e})=>{const t=`${window.location.origin}/post/${e.slug||e.id}`;return o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(At,{url:t,title:e.title,children:o.jsx(Et,{size:32,round:!0})}),o.jsx(st,{url:t,hashtag:e.title.replace(/\s/g,""),children:o.jsx(rt,{size:32,round:!0})}),o.jsx(pt,{url:t,title:e.title,children:o.jsx(wt,{size:32,round:!0})}),o.jsx(nt,{url:t,subject:e.title,children:o.jsx(et,{size:32,round:!0})})]})};function Ft(){const{slug:e}=xe(),[t,n]=v.useState(null),[i,a]=v.useState(!0),s=v.useRef(null);return v.useEffect(()=>{(async()=>{if(e){a(!0);try{const h=T(A,"posts"),u=te(h,G("slug","==",e),G("status","==","published")),r=await ne(u);if(r.empty)console.log("No such document!");else{const c=r.docs[0],d={id:c.id,...c.data()};if(n(d),document.title=d.title,d.metaDescription){const f=document.querySelector('meta[name="description"]');if(f)f.setAttribute("content",d.metaDescription);else{const w=document.createElement("meta");w.name="description",w.content=d.metaDescription,document.head.appendChild(w)}}}}catch(h){console.error("Error fetching post:",h)}finally{a(!1)}}})()},[e]),v.useEffect(()=>{if(t?.content&&s.current){const l=je.sanitize(t.content,{USE_PROFILES:{html:!0}});s.current.innerHTML=l,s.current.querySelectorAll("pre code").forEach(h=>{Ce.highlightElement(h)})}},[t]),i?o.jsx("div",{className:"text-center p-8 text-text",children:"Loading post..."}):t?o.jsxs("div",{className:"max-w-4xl mx-auto space-y-12",children:[o.jsxs("article",{children:[o.jsxs("header",{className:"mb-8",children:[o.jsxs(q,{to:"/posts",className:"inline-flex items-center gap-2 text-accent mb-4 hover:underline",children:[o.jsx(Le,{size:16}),"Back to all articles"]}),o.jsx("h1",{className:"text-4xl md:text-5xl font-extrabold text-text leading-tight mb-3",children:t.title}),t.readTime&&o.jsxs("div",{className:"flex items-center gap-2 text-muted text-sm mt-4",children:[o.jsx(Se,{size:16}),o.jsxs("span",{children:[t.readTime," min read"]})]})]}),o.jsxs(ye,{className:"p-12",children:[o.jsxs("div",{className:"flex items-center justify-between text-muted border-b border-border/10 pb-4 mb-8",children:[o.jsxs("div",{className:"flex items-center gap-6",children:[o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(ke,{size:18}),o.jsx("span",{className:"font-medium text-text",children:t.authorName||"Chiari Voices Admin"})]}),o.jsxs("span",{className:"flex items-center gap-2",children:[o.jsx(Ne,{size:18}),o.jsx("span",{children:t.createdAt?.seconds?Pe(new Date(t.createdAt.seconds*1e3),"MMMM d, yyyy"):"Unknown Date"})]})]}),o.jsx("div",{className:"flex items-center gap-2",children:o.jsx(It,{post:t})})]}),t.imageUrl&&o.jsx("img",{src:t.imageUrl,alt:t.title,className:"w-full h-auto object-cover rounded-xl mb-8"}),o.jsx("div",{id:"post-content",ref:s,className:"prose prose-invert prose-lg max-w-none mx-auto text-text/90 prose-headings:text-text prose-a:text-accent prose-strong:text-text prose-blockquote:border-accent"}),t.tags&&t.tags.length>0&&o.jsxs("div",{className:"mt-8 pt-6 border-t border-border/10 flex flex-wrap items-center gap-3",children:[o.jsx("span",{className:"font-semibold text-text",children:o.jsx(_e,{size:16})}),t.tags.map(l=>o.jsx(q,{to:`/posts?tag=${l}`,className:"px-3 py-1 text-sm rounded-full bg-accent/10 text-accent hover:bg-accent/20 transition-colors",children:l},l))]})]})]}),o.jsx(We,{postId:t.id})]}):o.jsxs("div",{className:"text-center p-8",children:[o.jsx("h2",{className:"text-2xl font-bold mb-4 text-text",children:"Post not found"}),o.jsx(q,{to:"/",children:o.jsx(V,{variant:"primary",children:"Back to Home"})})]})}export{Ft as default};
