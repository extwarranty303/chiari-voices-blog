import{r as g,j as h,W as z,Y as K,Z as U,_ as q,B as T,N as G,u as $,Q,a as Z,d as X,P as ee}from"./index-Cwzn0Rv2.js";var E={exports:{}},_,L;function ne(){if(L)return _;L=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return _=t,_}var j,P;function te(){if(P)return j;P=1;var t=ne();function r(){}function i(){}return i.resetWarningCache=r,j=function(){function o(e,s,u,f,l,d){if(d!==t){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}o.isRequired=o;function a(){return o}var c={array:o,bigint:o,bool:o,func:o,number:o,object:o,string:o,symbol:o,any:o,arrayOf:a,element:o,elementType:o,instanceOf:a,node:o,objectOf:a,oneOf:a,oneOfType:a,shape:a,exact:a,checkPropTypes:i,resetWarningCache:r};return c.PropTypes=c,c},j}var D;function re(){return D||(D=1,E.exports=te()()),E.exports}var n=re(),w=function(){return w=Object.assign||function(t){for(var r,i=1,o=arguments.length;i<o;i++){r=arguments[i];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},w.apply(this,arguments)},W={onActivate:n.func,onAddUndo:n.func,onBeforeAddUndo:n.func,onBeforeExecCommand:n.func,onBeforeGetContent:n.func,onBeforeRenderUI:n.func,onBeforeSetContent:n.func,onBeforePaste:n.func,onBlur:n.func,onChange:n.func,onClearUndos:n.func,onClick:n.func,onContextMenu:n.func,onCommentChange:n.func,onCompositionEnd:n.func,onCompositionStart:n.func,onCompositionUpdate:n.func,onCopy:n.func,onCut:n.func,onDblclick:n.func,onDeactivate:n.func,onDirty:n.func,onDrag:n.func,onDragDrop:n.func,onDragEnd:n.func,onDragGesture:n.func,onDragOver:n.func,onDrop:n.func,onExecCommand:n.func,onFocus:n.func,onFocusIn:n.func,onFocusOut:n.func,onGetContent:n.func,onHide:n.func,onInit:n.func,onInput:n.func,onKeyDown:n.func,onKeyPress:n.func,onKeyUp:n.func,onLoadContent:n.func,onMouseDown:n.func,onMouseEnter:n.func,onMouseLeave:n.func,onMouseMove:n.func,onMouseOut:n.func,onMouseOver:n.func,onMouseUp:n.func,onNodeChange:n.func,onObjectResizeStart:n.func,onObjectResized:n.func,onObjectSelected:n.func,onPaste:n.func,onPostProcess:n.func,onPostRender:n.func,onPreProcess:n.func,onProgressState:n.func,onRedo:n.func,onRemove:n.func,onReset:n.func,onSaveContent:n.func,onSelectionChange:n.func,onSetAttrib:n.func,onSetContent:n.func,onShow:n.func,onSubmit:n.func,onUndo:n.func,onVisualAid:n.func,onSkinLoadError:n.func,onThemeLoadError:n.func,onModelLoadError:n.func,onPluginLoadError:n.func,onIconsLoadError:n.func,onLanguageLoadError:n.func,onScriptsLoad:n.func,onScriptsLoadError:n.func},oe=w({apiKey:n.string,licenseKey:n.string,id:n.string,inline:n.bool,init:n.object,initialValue:n.string,onEditorChange:n.func,value:n.string,tagName:n.string,tabIndex:n.number,cloudChannel:n.string,plugins:n.oneOfType([n.string,n.array]),toolbar:n.oneOfType([n.string,n.array]),disabled:n.bool,readonly:n.bool,textareaName:n.string,tinymceScriptSrc:n.oneOfType([n.string,n.arrayOf(n.string),n.arrayOf(n.shape({src:n.string,async:n.bool,defer:n.bool}))]),rollback:n.oneOfType([n.number,n.oneOf([!1])]),scriptLoading:n.shape({async:n.bool,defer:n.bool,delay:n.number})},W),J=function(t){var r=t;return r&&r.tinymce?r.tinymce:null},k=function(t){return typeof t=="function"},R=function(t){return t in W},B=function(t){return t.substr(2)},ie=function(t,r,i,o,a,c,e){var s=Object.keys(a).filter(R),u=Object.keys(c).filter(R),f=s.filter(function(d){return c[d]===void 0}),l=u.filter(function(d){return a[d]===void 0});f.forEach(function(d){var p=B(d),v=e[p];i(p,v),delete e[p]}),l.forEach(function(d){var p=o(t,d),v=B(d);e[v]=p,r(v,p)})},ae=function(t,r,i,o,a){return ie(a,t.on.bind(t),t.off.bind(t),function(c,e){return function(s){var u;return(u=c(e))===null||u===void 0?void 0:u(s,t)}},r,i,o)},M=0,Y=function(t){var r=Date.now(),i=Math.floor(Math.random()*1e9);return M++,t+"_"+i+M+String(r)},A=function(t){return t!==null&&(t.tagName.toLowerCase()==="textarea"||t.tagName.toLowerCase()==="input")},F=function(t){return typeof t>"u"||t===""?[]:Array.isArray(t)?t:t.split(" ")},se=function(t,r){return F(t).concat(F(r))},ce=function(){return window.InputEvent&&typeof InputEvent.prototype.getTargetRanges=="function"},ue=function(t){if(!("isConnected"in Node.prototype)){for(var r=t,i=t.parentNode;i!=null;)r=i,i=r.parentNode;return r===t.ownerDocument}return t.isConnected},H=function(t,r){t!==void 0&&(t.mode!=null&&typeof t.mode=="object"&&typeof t.mode.set=="function"?t.mode.set(r):t.setMode(r))},le=function(t){var r=J(t);if(!r)throw new Error("tinymce should have been loaded into global scope");return r},V=function(t){return t.options&&t.options.isRegistered("disabled")},O=function(){return O=Object.assign||function(t){for(var r,i=1,o=arguments.length;i<o;i++){r=arguments[i];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},O.apply(this,arguments)},de=function(t,r,i){var o,a,c=t.createElement("script");c.referrerPolicy="origin",c.type="application/javascript",c.id=r.id,c.src=r.src,c.async=(o=r.async)!==null&&o!==void 0?o:!1,c.defer=(a=r.defer)!==null&&a!==void 0?a:!1;var e=function(){c.removeEventListener("load",e),c.removeEventListener("error",s),i(r.src)},s=function(u){c.removeEventListener("load",e),c.removeEventListener("error",s),i(r.src,u)};c.addEventListener("load",e),c.addEventListener("error",s),t.head&&t.head.appendChild(c)},fe=function(t){var r={},i=function(e,s){var u=r[e];u.done=!0,u.error=s;for(var f=0,l=u.handlers;f<l.length;f++){var d=l[f];d(e,s)}u.handlers=[]},o=function(e,s,u){var f=function(C){return u!==void 0?u(C):console.error(C)};if(e.length===0){f(new Error("At least one script must be provided"));return}for(var l=0,d=!1,p=function(C,I){d||(I?(d=!0,f(I)):++l===e.length&&s())},v=0,y=e;v<y.length;v++){var m=y[v],b=r[m.src];if(b)b.done?p(m.src,b.error):b.handlers.push(p);else{var N=Y("tiny-");r[m.src]={id:N,src:m.src,done:!1,error:null,handlers:[p]},de(t,O({id:N},m),i)}}},a=function(){for(var e,s=0,u=Object.values(r);s<u.length;s++){var f=u[s],l=t.getElementById(f.id);l!=null&&l.tagName==="SCRIPT"&&((e=l.parentNode)===null||e===void 0||e.removeChild(l))}r={}},c=function(){return t};return{loadScripts:o,deleteScripts:a,getDocument:c}},pe=function(){var t=[],r=function(a){var c=t.find(function(e){return e.getDocument()===a});return c===void 0&&(c=fe(a),t.push(c)),c},i=function(a,c,e,s,u){var f=function(){return r(a).loadScripts(c,s,u)};e>0?setTimeout(f,e):f()},o=function(){for(var a=t.pop();a!=null;a=t.pop())a.deleteScripts()};return{loadList:i,reinitialize:o}},he=pe(),ve=(function(){var t=function(r,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(o,a){o.__proto__=a}||function(o,a){for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(o[c]=a[c])},t(r,i)};return function(r,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(r,i);function o(){this.constructor=r}r.prototype=i===null?Object.create(i):(o.prototype=i.prototype,new o)}})(),S=function(){return S=Object.assign||function(t){for(var r,i=1,o=arguments.length;i<o;i++){r=arguments[i];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},S.apply(this,arguments)},x="change keyup compositionend setcontent CommentChange",ye=(function(t){ve(r,t);function r(i){var o,a,c,e=t.call(this,i)||this;return e.rollbackTimer=void 0,e.valueCursor=void 0,e.rollbackChange=function(){var s=e.editor,u=e.props.value;s&&u&&u!==e.currentContent&&s.undoManager.ignore(function(){if(s.setContent(u),e.valueCursor&&(!e.inline||s.hasFocus()))try{s.selection.moveToBookmark(e.valueCursor)}catch{}}),e.rollbackTimer=void 0},e.handleBeforeInput=function(s){if(e.props.value!==void 0&&e.props.value===e.currentContent&&e.editor&&(!e.inline||e.editor.hasFocus()))try{e.valueCursor=e.editor.selection.getBookmark(3)}catch{}},e.handleBeforeInputSpecial=function(s){(s.key==="Enter"||s.key==="Backspace"||s.key==="Delete")&&e.handleBeforeInput(s)},e.handleEditorChange=function(s){var u=e.editor;if(u&&u.initialized){var f=u.getContent();e.props.value!==void 0&&e.props.value!==f&&e.props.rollback!==!1&&(e.rollbackTimer||(e.rollbackTimer=window.setTimeout(e.rollbackChange,typeof e.props.rollback=="number"?e.props.rollback:200))),f!==e.currentContent&&(e.currentContent=f,k(e.props.onEditorChange)&&e.props.onEditorChange(f,u))}},e.handleEditorChangeSpecial=function(s){(s.key==="Backspace"||s.key==="Delete")&&e.handleEditorChange(s)},e.initialise=function(s){var u,f,l;s===void 0&&(s=0);var d=e.elementRef.current;if(d){if(!ue(d)){if(s===0)setTimeout(function(){return e.initialise(1)},1);else if(s<100)setTimeout(function(){return e.initialise(s+1)},100);else throw new Error("tinymce can only be initialised when in a document");return}var p=le(e.view),v=S(S(S(S({},e.props.init),{selector:void 0,target:d,disabled:e.props.disabled,readonly:e.props.readonly,inline:e.inline,plugins:se((u=e.props.init)===null||u===void 0?void 0:u.plugins,e.props.plugins),toolbar:(f=e.props.toolbar)!==null&&f!==void 0?f:(l=e.props.init)===null||l===void 0?void 0:l.toolbar}),e.props.licenseKey?{license_key:e.props.licenseKey}:{}),{setup:function(y){e.editor=y,e.bindHandlers({}),e.inline&&!A(d)&&y.once("PostRender",function(m){y.setContent(e.getInitialValue(),{no_events:!0})}),e.props.init&&k(e.props.init.setup)&&e.props.init.setup(y),e.props.disabled&&(V(e.editor)?e.editor.options.set("disabled",e.props.disabled):e.editor.mode.set("readonly"))},init_instance_callback:function(y){var m,b=e.getInitialValue();e.currentContent=(m=e.currentContent)!==null&&m!==void 0?m:y.getContent(),e.currentContent!==b&&(e.currentContent=b,y.setContent(b),y.undoManager.clear(),y.undoManager.add(),y.setDirty(!1)),e.props.init&&k(e.props.init.init_instance_callback)&&e.props.init.init_instance_callback(y)}});e.inline||(d.style.visibility=""),A(d)&&(d.value=e.getInitialValue()),p.init(v)}},e.id=e.props.id||Y("tiny-react"),e.elementRef=g.createRef(),e.inline=(c=(o=e.props.inline)!==null&&o!==void 0?o:(a=e.props.init)===null||a===void 0?void 0:a.inline)!==null&&c!==void 0?c:!1,e.boundHandlers={},e}return Object.defineProperty(r.prototype,"view",{get:function(){var i,o;return(o=(i=this.elementRef.current)===null||i===void 0?void 0:i.ownerDocument.defaultView)!==null&&o!==void 0?o:window},enumerable:!1,configurable:!0}),r.prototype.componentDidUpdate=function(i){var o=this,a,c;if(this.rollbackTimer&&(clearTimeout(this.rollbackTimer),this.rollbackTimer=void 0),this.editor&&(this.bindHandlers(i),this.editor.initialized)){if(this.currentContent=(a=this.currentContent)!==null&&a!==void 0?a:this.editor.getContent(),typeof this.props.initialValue=="string"&&this.props.initialValue!==i.initialValue)this.editor.setContent(this.props.initialValue),this.editor.undoManager.clear(),this.editor.undoManager.add(),this.editor.setDirty(!1);else if(typeof this.props.value=="string"&&this.props.value!==this.currentContent){var e=this.editor;e.undoManager.transact(function(){var u;if(!o.inline||e.hasFocus())try{u=e.selection.getBookmark(3)}catch{}var f=o.valueCursor;if(e.setContent(o.props.value),!o.inline||e.hasFocus())for(var l=0,d=[u,f];l<d.length;l++){var p=d[l];if(p)try{e.selection.moveToBookmark(p),o.valueCursor=p;break}catch{}}})}if(this.props.readonly!==i.readonly){var s=(c=this.props.readonly)!==null&&c!==void 0?c:!1;H(this.editor,s?"readonly":"design")}this.props.disabled!==i.disabled&&(V(this.editor)?this.editor.options.set("disabled",this.props.disabled):H(this.editor,this.props.disabled?"readonly":"design"))}},r.prototype.componentDidMount=function(){var i=this,o,a,c,e,s;if(J(this.view)!==null)this.initialise();else if(Array.isArray(this.props.tinymceScriptSrc)&&this.props.tinymceScriptSrc.length===0)(a=(o=this.props).onScriptsLoadError)===null||a===void 0||a.call(o,new Error("No `tinymce` global is present but the `tinymceScriptSrc` prop was an empty array."));else if(!((c=this.elementRef.current)===null||c===void 0)&&c.ownerDocument){var u=function(){var l,d;(d=(l=i.props).onScriptsLoad)===null||d===void 0||d.call(l),i.initialise()},f=function(l){var d,p;(p=(d=i.props).onScriptsLoadError)===null||p===void 0||p.call(d,l)};he.loadList(this.elementRef.current.ownerDocument,this.getScriptSources(),(s=(e=this.props.scriptLoading)===null||e===void 0?void 0:e.delay)!==null&&s!==void 0?s:0,u,f)}},r.prototype.componentWillUnmount=function(){var i=this,o=this.editor;o&&(o.off(x,this.handleEditorChange),o.off(this.beforeInputEvent(),this.handleBeforeInput),o.off("keypress",this.handleEditorChangeSpecial),o.off("keydown",this.handleBeforeInputSpecial),o.off("NewBlock",this.handleEditorChange),Object.keys(this.boundHandlers).forEach(function(a){o.off(a,i.boundHandlers[a])}),this.boundHandlers={},o.remove(),this.editor=void 0)},r.prototype.render=function(){return this.inline?this.renderInline():this.renderIframe()},r.prototype.beforeInputEvent=function(){return ce()?"beforeinput SelectionChange":"SelectionChange"},r.prototype.renderInline=function(){var i=this.props.tagName,o=i===void 0?"div":i;return g.createElement(o,{ref:this.elementRef,id:this.id,tabIndex:this.props.tabIndex})},r.prototype.renderIframe=function(){return g.createElement("textarea",{ref:this.elementRef,style:{visibility:"hidden"},name:this.props.textareaName,id:this.id,tabIndex:this.props.tabIndex})},r.prototype.getScriptSources=function(){var i,o,a=(i=this.props.scriptLoading)===null||i===void 0?void 0:i.async,c=(o=this.props.scriptLoading)===null||o===void 0?void 0:o.defer;if(this.props.tinymceScriptSrc!==void 0)return typeof this.props.tinymceScriptSrc=="string"?[{src:this.props.tinymceScriptSrc,async:a,defer:c}]:this.props.tinymceScriptSrc.map(function(f){return typeof f=="string"?{src:f,async:a,defer:c}:f});var e=this.props.cloudChannel,s=this.props.apiKey?this.props.apiKey:"no-api-key",u="https://cdn.tiny.cloud/1/".concat(s,"/tinymce/").concat(e,"/tinymce.min.js");return[{src:u,async:a,defer:c}]},r.prototype.getInitialValue=function(){return typeof this.props.initialValue=="string"?this.props.initialValue:typeof this.props.value=="string"?this.props.value:""},r.prototype.bindHandlers=function(i){var o=this;if(this.editor!==void 0){ae(this.editor,i,this.props,this.boundHandlers,function(s){return o.props[s]});var a=function(s){return s.onEditorChange!==void 0||s.value!==void 0},c=a(i),e=a(this.props);!c&&e?(this.editor.on(x,this.handleEditorChange),this.editor.on(this.beforeInputEvent(),this.handleBeforeInput),this.editor.on("keydown",this.handleBeforeInputSpecial),this.editor.on("keyup",this.handleEditorChangeSpecial),this.editor.on("NewBlock",this.handleEditorChange)):c&&!e&&(this.editor.off(x,this.handleEditorChange),this.editor.off(this.beforeInputEvent(),this.handleBeforeInput),this.editor.off("keydown",this.handleBeforeInputSpecial),this.editor.off("keyup",this.handleEditorChangeSpecial),this.editor.off("NewBlock",this.handleEditorChange))}},r.propTypes=oe,r.defaultProps={cloudChannel:"8"},r})(g.Component);function ge({initialValue:t,onSave:r}){return h.jsx(ye,{apiKey:"42hywlzjyvoo3tuf9znbap1bm1lljzz307wqb51fltlkwu6f",initialValue:t,init:{skin:"oxide-dark",content_css:"dark",height:500,menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount autosave"],toolbar:"undo redo | formatselect | bold italic backcolor |           alignleft aligncenter alignright alignjustify |           bullist numlist outdent indent | removeformat | help",autosave_ask_before_unload:!0,autosave_interval:"30s",autosave_prefix:"{path}{query}-{id}-",autosave_restore_when_empty:!1,autosave_retention:"2m",content_style:"body { font-family:Helvetica,Arial,sans-serif; font-size:14px }"},onSaveContent:i=>r(i)})}const me=["Headache","Neck Pain","Dizziness","Nausea","Fatigue","Tinnitus","Brain Fog","Visual Disturbances","Numbness/Tingling"];function be({onSave:t,isSaving:r}){const[i,o]=g.useState([]),[a,c]=g.useState(0),[e,s]=g.useState(""),u=l=>{o(d=>d.includes(l)?d.filter(p=>p!==l):[...d,l])},f=()=>{t({symptoms:i,painLevel:a,notes:e,timestamp:new Date().toISOString()})};return h.jsxs(z,{children:[h.jsx(K,{children:h.jsx(U,{children:"Log Your Symptoms"})}),h.jsxs(q,{className:"space-y-6",children:[h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold mb-2",children:"Common Symptoms"}),h.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-2",children:me.map(l=>h.jsx(T,{variant:i.includes(l)?"secondary":"outline",onClick:()=>u(l),className:"w-full justify-start text-left h-auto py-2",children:l},l))})]}),h.jsxs("div",{children:[h.jsxs("h4",{className:"font-semibold mb-2",children:["Pain Level: ",a]}),h.jsx("input",{type:"range",min:"0",max:"10",value:a,onChange:l=>c(Number(l.target.value)),className:"w-full"})]}),h.jsxs("div",{children:[h.jsx("h4",{className:"font-semibold mb-2",children:"Notes"}),h.jsx("textarea",{value:e,onChange:l=>s(l.target.value),className:"w-full p-2 rounded bg-background border border-surface/20",rows:4,placeholder:"Any additional details..."})]}),h.jsx(T,{onClick:f,disabled:r,children:r?"Saving...":"Save Symptom Log"})]})]})}const Se=[{type:"paragraph",children:[{text:""}]}],Ee=()=>{const{user:t}=G(),r=$(),[i,o]=g.useState(Se),[a,c]=g.useState([]),[e,s]=g.useState(!1),u=p=>{try{const v=JSON.parse(p);o(v)}catch(v){console.error("Error parsing content:",v)}},f=p=>{const v=p.symptoms.map(y=>({symptom:y,severity:p.painLevel,timestamp:new Date(p.timestamp)}));c(y=>[...y,...v])},l=async()=>{if(!t){alert("You must be logged in to save a journal entry.");return}s(!0);try{await Q(Z(X,"users",t.uid,"journalEntries"),{content:JSON.stringify(i),symptoms:a,createdAt:ee()}),r("/journal")}catch(p){console.error("Error saving journal entry: ",p),alert("Failed to save journal entry. Please try again.")}finally{s(!1)}},d=g.useMemo(()=>h.jsx(ge,{initialValue:JSON.stringify(i),onSave:u}),[i]);return h.jsxs("div",{className:"container mx-auto p-4 md:p-8 text-white",children:[h.jsxs("div",{className:"flex justify-between items-center mb-8",children:[h.jsx("h1",{className:"text-4xl font-bold",children:"New Journal Entry"}),h.jsx(T,{onClick:l,disabled:e,children:e?"Saving...":"Save Entry"})]}),h.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[h.jsx("div",{className:"lg:col-span-2",children:h.jsxs(z,{className:"bg-gray-800 border-gray-700",children:[h.jsx(K,{children:h.jsx(U,{children:"Today's Thoughts & Feelings"})}),h.jsx(q,{children:d})]})}),h.jsx("div",{children:h.jsx(be,{onSave:f,isSaving:e})})]})]})};export{Ee as default};
