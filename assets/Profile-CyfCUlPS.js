import{c as M,r as a,j as e,t as O,v as q,x as K,L as A,G as $,y as H,I as D,T as ee,B as G,k as L,d as g,e as S,p as T,q as B,w as R,z as se,a as F,g as Z,A as te,C as ae,D as le,E as re,h as ie,H as ne}from"./index-Cwzn0Rv2.js";import{A as oe}from"./arrow-left-BkWR1XFE.js";const ce=[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]],de=M("bookmark",ce);const me=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],xe=M("camera",me),ue=({tabs:s})=>{const[t,n]=a.useState(0);return e.jsxs("div",{children:[e.jsx("div",{className:"border-b border-gray-700",children:e.jsx("nav",{className:"-mb-px flex space-x-8","aria-label":"Tabs",children:s.map((r,o)=>e.jsx("button",{onClick:()=>n(o),className:O("whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm",t===o?"border-purple-500 text-purple-400":"border-transparent text-gray-400 hover:text-gray-200 hover:border-gray-500"),children:r.label},r.label))})}),e.jsx("div",{className:"mt-8",children:s[t].content})]})},he=()=>{const{isSymptomSafe:s,toggleSymptomSafe:t}=q(),{isDyslexicFont:n,toggleDyslexicFont:r}=K();return e.jsxs("div",{className:"space-y-6",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Accessibility Settings"}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-800 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-white",children:"Symptom-Safe Mode"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Hides potentially triggering images and content."})]}),e.jsx("button",{onClick:t,className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors ${s?"bg-purple-600":"bg-gray-600"}`,children:e.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${s?"translate-x-6":"translate-x-1"}`})})]}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-800 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-white",children:"Dyslexia-Friendly Font"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Uses a font designed to be easier to read for people with dyslexia."})]}),e.jsx("button",{onClick:r,className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors ${n?"bg-purple-600":"bg-gray-600"}`,children:e.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${n?"translate-x-6":"translate-x-1"}`})})]})]})},fe=({posts:s})=>e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[e.jsx(de,{})," Bookmarked Stories"]}),s.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:s.map(t=>e.jsx(A,{to:`/posts/${t.slug}`,children:e.jsxs($,{className:"p-6 h-full hover:bg-surface/20 transition-colors duration-300 transform hover:-translate-y-1",children:[e.jsx("h3",{className:"font-semibold text-lg text-white mb-2",children:t.title}),e.jsx("p",{className:"text-surface/70 text-sm line-clamp-3",children:t.excerpt})]})},t.id))}):e.jsx("p",{className:"text-surface/60 text-sm",children:"You haven't bookmarked any stories yet."})]}),Y="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgdmlld0JveD0iMCAwIDEwMCAxMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxjaXJjbGUgY3g9IjUwIiBjeT0iNTAiIHI9IjUwIiBmaWxsPSIjNEE1NTY4Ii8+Cjx0ZXh0IHg9IjUwJSIgeT0iNTAlIiBkb21pbmFudC1iYXNlbGluZT0ibWlkZGxlIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmb250LWZhbWlseT0iQXJpYWwsIHNhbnMtc2VyaWYiIGZvbnQtc2l6ZT0iNDAiIGZpbGw9IndoaXRlIiBkeT0iLjNlbSI+Q1Y8L3RleHQ+Cjwvc3ZnPgo=",pe=({firstName:s,setFirstName:t,lastName:n,setLastName:r,bio:o,setBio:d,isPublic:m,setIsPublic:u,setAvatarFile:b,avatarPreview:j,setAvatarPreview:y,handleSaveChanges:v,isSaving:h})=>{const{user:f}=H(),N=i=>{if(i.target.files&&i.target.files[0]){const p=i.target.files[0];b(p),y(URL.createObjectURL(p))}};return f?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative w-24 h-24 mx-auto",children:[e.jsx("img",{src:j||f.photoURL||Y,alt:"Profile",className:"w-full h-full rounded-full border-2 border-accent/50 object-cover"}),e.jsxs("label",{htmlFor:"avatar-upload",className:"absolute inset-0 bg-black/50 flex items-center justify-center rounded-full cursor-pointer text-white opacity-0 hover:opacity-100 transition-opacity",children:[e.jsx(xe,{size:24}),e.jsx("input",{id:"avatar-upload",type:"file",className:"hidden",accept:"image/*",onChange:N})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(D,{label:"First Name",value:s,onChange:i=>t(i.target.value),placeholder:"Your First Name"}),e.jsx(D,{label:"Last Name",value:n,onChange:i=>r(i.target.value),placeholder:"Your Last Name"})]}),e.jsx(ee,{label:"Bio",value:o,onChange:i=>d(i.target.value),placeholder:"Tell us a little about yourself...",rows:4}),e.jsxs("div",{className:"flex items-center justify-between bg-gray-800 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-white",children:"Make Profile Public"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Allow other users to see your profile."})]}),e.jsx("button",{onClick:()=>u(!m),className:`relative inline-flex items-center h-6 rounded-full w-11 transition-colors ${m?"bg-purple-600":"bg-gray-600"}`,children:e.jsx("span",{className:`inline-block w-4 h-4 transform bg-white rounded-full transition-transform ${m?"translate-x-6":"translate-x-1"}`})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(G,{onClick:v,disabled:h,children:h?"Saving...":"Save Changes"})})]}):null},ge=({comments:s})=>e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"My Activity"}),s.length>0?e.jsx("ul",{className:"space-y-4",children:s.map(t=>e.jsxs("li",{className:"bg-gray-800 p-4 rounded-lg",children:[e.jsx("p",{className:"text-gray-300",children:t.content}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:[e.jsx("span",{children:"Commented on "}),e.jsx(A,{to:`/posts/${t.postId}`,className:"text-purple-400 hover:underline",children:t.postTitle}),e.jsxs("span",{children:[" â€¢ ",new Date(t.createdAt).toLocaleDateString()]})]})]},t.id))}):e.jsx("p",{className:"text-surface/60 text-sm",children:"You haven't made any comments yet."})]});function ye(){const{user:s,loading:t,logout:n}=H(),[r,o]=a.useState(""),[d,m]=a.useState(""),[u,b]=a.useState(""),[j,y]=a.useState(!1),[v,h]=a.useState(null),[f,N]=a.useState(null),[i,p]=a.useState(!1),[E,W]=a.useState([]),[z,Q]=a.useState([]),[C,X]=a.useState(""),[J,U]=a.useState(!0);a.useEffect(()=>{if(!t&&s&&s.uid){const c=L(g,"users",s.uid);S.currentUser?.metadata?.creationTime&&X(new Date(S.currentUser.metadata.creationTime).getFullYear().toString()),T(c).then(async x=>{if(x.exists()){const l=x.data();if(o(l.firstName||""),m(l.lastName||""),b(l.bio||""),y(l.isPublic||!1),l.bookmarkedPosts&&l.bookmarkedPosts.length>0){const w=B(F(g,"posts"),R(se(),"in",l.bookmarkedPosts)),k=await Z(w);W(k.docs.map(I=>({id:I.id,...I.data()})))}}});const P=B(F(g,"comments"),R("userId","==",s.uid));Z(P).then(async x=>{const l=await Promise.all(x.docs.map(async w=>{const k=w.data(),I=await T(L(g,"posts",k.postId));return{id:w.id,postTitle:I.data()?.title||"Untitled Post",...k}}));Q(l)}),U(!1)}else t||U(!1)},[s,t]);const V=async()=>{if(!(!s||!S.currentUser)){p(!0);try{let c=s.photoURL;if(v){const l=te(ae,`avatars/${s.uid}`);await le(l,v),c=await re(l)}const P=`${r} ${d}`.trim();await ie(S.currentUser,{displayName:P,photoURL:c});const x=L(g,"users",s.uid);await ne(x,{firstName:r,lastName:d,photoURL:c,bio:u,isPublic:j}),alert("Profile updated successfully!"),h(null),N(null)}catch(c){console.error("Error updating profile:",c),alert("Failed to update profile. Please try again.")}finally{p(!1)}}},_=[{label:"Edit Profile",content:e.jsx(pe,{firstName:r,setFirstName:o,lastName:d,setLastName:m,bio:u,setBio:b,isPublic:j,setIsPublic:y,setAvatarFile:h,avatarPreview:f,setAvatarPreview:N,handleSaveChanges:V,isSaving:i})},{label:"Bookmarked Posts",content:e.jsx(fe,{posts:E})},{label:"My Activity",content:e.jsx(ge,{comments:z})},{label:"Accessibility",content:e.jsx(he,{})}];return J?e.jsx("div",{className:"text-center p-8",children:"Loading profile..."}):s?e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs(A,{to:"/",className:"inline-flex items-center text-surface/60 hover:text-accent mb-6 transition-colors",children:[e.jsx(oe,{size:18,className:"mr-2"})," Back to Home"]}),e.jsxs($,{className:"p-8",children:[e.jsxs("div",{className:"flex items-start space-x-8",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:f||s.photoURL||Y,alt:"Profile",className:"w-24 h-24 rounded-full border-2 border-accent/50 object-cover"})}),e.jsxs("div",{className:"flex-grow",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:`${r} ${d}`.trim()||"Anonymous User"}),e.jsx("p",{className:"text-surface/60",children:s.email}),C&&e.jsxs("p",{className:"text-sm text-surface/50 mt-1",children:["Member since ",C]})]}),e.jsx(G,{onClick:n,children:"Log Out"})]}),e.jsx("p",{className:"mt-4 text-surface/80",children:u})]})]}),e.jsx("div",{className:"mt-8",children:e.jsx(ue,{tabs:_})})]})]}):e.jsx("div",{className:"text-center p-8",children:"Please log in to view your profile."})}export{ye as default};
