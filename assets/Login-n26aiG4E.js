import{c as L,r as c,u as R,j as e,G as F,I as p,B as f,b as q,F as B,s as G,e as u,f as W,h as O,i as C,k as y,d as w,m as U,n as z,p as S}from"./index-Cwzn0Rv2.js";import{C as M}from"./circle-check-big-BRKT5XWh.js";const _=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],H=L("circle-alert",_);function T(){const[r,k]=c.useState(!0),[i,P]=c.useState(""),[m,D]=c.useState(""),[x,A]=c.useState(""),[j,n]=c.useState(""),[v,l]=c.useState(""),[h,d]=c.useState(!1),o=R(),N=async s=>{try{const t=y(w,"users",s.uid),a=await S(t);if(a.exists()&&a.data().role==="admin"){o("/admin");return}o("/")}catch(t){console.error("Error checking role:",t),o("/")}},I=async s=>{s.preventDefault(),n(""),l(""),d(!0);try{if(r){const t=await G(u,i,m);await N(t.user)}else{const a=(await W(u,i,m)).user;await O(a,{displayName:x}),await C(y(w,"users",a.uid),{uid:a.uid,email:a.email,displayName:x,role:"user",createdAt:new Date().toISOString()}),o("/")}}catch(t){console.error(t),n(t.message||"Failed to authenticate")}finally{d(!1)}},E=async()=>{if(!i){n("Please enter your email to reset your password.");return}n(""),l(""),d(!0);try{await U(u,i),l("Password reset email sent! Check your inbox.")}catch(s){n(s.message||"Failed to send reset email.")}finally{d(!1)}},b=async s=>{n(""),l("");try{const a=(await z(u,s)).user,g=y(w,"users",a.uid);(await S(g)).exists()?await N(a):(await C(g,{uid:a.uid,email:a.email,displayName:a.displayName,role:"user",createdAt:new Date().toISOString()}),o("/"))}catch(t){n(t.message)}};return e.jsx("div",{className:"min-h-[80vh] flex items-center justify-center px-4",children:e.jsxs(F,{className:"w-full max-w-md p-8",children:[e.jsx("h2",{className:"text-3xl font-bold mb-6 text-center text-white",children:r?"Welcome Back":"Create Account"}),j&&e.jsxs("div",{className:"bg-red-500/20 border border-red-500/50 text-red-200 p-3 rounded-lg mb-4 flex items-center gap-2",children:[e.jsx(H,{size:18}),e.jsx("span",{className:"text-sm",children:j})]}),v&&e.jsxs("div",{className:"bg-green-500/20 border border-green-500/50 text-green-200 p-3 rounded-lg mb-4 flex items-center gap-2",children:[e.jsx(M,{size:18}),e.jsx("span",{className:"text-sm",children:v})]}),e.jsxs("form",{onSubmit:I,className:"space-y-4",children:[!r&&e.jsx(p,{type:"text",placeholder:"Full Name",value:x,onChange:s=>A(s.target.value),required:!0}),e.jsx(p,{type:"email",placeholder:"Email Address",value:i,onChange:s=>P(s.target.value),required:!0}),e.jsx(p,{type:"password",placeholder:"Password",value:m,onChange:s=>D(s.target.value),required:!0}),r&&e.jsx("div",{className:"text-right -mb-2",children:e.jsx("button",{type:"button",onClick:E,disabled:h,className:"text-sm text-surface/80 hover:text-accent hover:underline font-medium",children:"Forgot Password?"})}),e.jsx(f,{type:"submit",className:"w-full !mt-6",disabled:h,children:h?"Processing...":r?"Log In":"Sign Up"})]}),e.jsxs("div",{className:"my-6 flex items-center gap-4",children:[e.jsx("div",{className:"h-[1px] bg-surface/10 flex-1"}),e.jsx("span",{className:"text-sm text-surface/60",children:"OR"}),e.jsx("div",{className:"h-[1px] bg-surface/10 flex-1"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(f,{variant:"secondary",className:"w-full",onClick:()=>b(new q),children:"Continue with Google"}),e.jsx(f,{variant:"secondary",className:"w-full",onClick:()=>b(new B),children:"Continue with Facebook"})]}),e.jsxs("p",{className:"mt-6 text-center text-sm text-surface/80",children:[r?"Don't have an account? ":"Already have an account? ",e.jsx("button",{onClick:()=>{k(!r),n(""),l("")},className:"text-accent hover:text-accent/80 font-medium hover:underline",children:r?"Sign Up":"Log In"})]})]})})}export{T as default};
